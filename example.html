<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">
    <title>AR Sun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/suncalc/1.8.0/suncalc.min.js"></script>
<body style='margin : 0px; overflow: hidden;'>
    <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
        <!-- Add a 3D sphere to represent the sun -->
        <a-sphere color="#FF0000" radius="1" position="0 0 -100" id="sun"></a-sphere>

        <!-- Add text elements for position and date information -->
        <a-entity position="0 0 -1" text="value: User position: " id="user-position"></a-entity>
        <a-entity position="0 0 -1.5" text="value: Sun position: " id="sun-position"></a-entity>
        <a-entity position="0 0 -2" text="value: Date: " id="date"></a-entity>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Get references to UI text elements
        var userPosition = document.querySelector('#user-position');
        var sunPosition = document.querySelector('#sun-position');
        var dateText = document.querySelector('#date');

        // Get user's current location
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(resolve, reject);
            });
        }

        // Update the position of the sun based on user location and time
        function updateSunPosition(lat, long) {
            try {
                // Calculate sun's position
                var date = new Date();
                var sunPos = SunCalc.getPosition(date, lat, long);

                // Update sun position in 3D space
                var sphere = document.querySelector('#sun');
                var distance = 1000;
                var position = `${-sunPos.azimuth * distance} 0 ${-sunPos.altitude * distance}`;
                var size = 100 * (1 / Math.tan(sunPos.altitude + (Math.PI / 180)));
                sphere.setAttribute('position', position);
                sphere.setAttribute('scale', `${size} ${size} ${size}`);

                // Update UI with positions and date
                userPosition.setAttribute('text', `value: User position: ${lat.toFixed(4)}, ${long.toFixed(4)}`);
                sunPosition.setAttribute('text', `value: Sun position: ${position}`);
                dateText.setAttribute('text', `value: Date: ${date}`);
            } catch (err) {
                console.error(err);
            }
        }

        // Update sun position every 30 seconds
        setInterval(() => {
            getUserLocation().then(pos => {
                updateSunPosition(pos.coords.latitude, pos.coords.longitude);
            }).catch(err => {
                console.error(err);
            });
        }, 30000);
    </script>
</body>
</html>
