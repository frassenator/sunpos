<!DOCTYPE html>
<html>
  <head>
    <title>AR.js A-Frame Location-based</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex-location-only.js'></script>
    <script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>
    <script>
window.onload = () => {
    let testEntityAdded = false;

    const el = document.querySelector("[gps-new-camera]");

    el.addEventListener("gps-camera-update-position", e => {
        if(!testEntityAdded) {
            alert("Got first GPS position: lon " + e.detail.position.longitude + " lat " + e.detail.position.latitude);
            // Add a box to the north of the initial GPS position
            const entity = document.getElementById("basebox");
            entity.setAttribute("scale", {
                x: 50, 
                y: 50,
                z: 50
            });
            entity.setAttribute('material', { color: 'red' } );
            entity.setAttribute('gps-new-entity-place', {
                latitude: e.detail.position.latitude + 0.001,
                longitude: e.detail.position.longitude
            });
            document.querySelector("a-scene").appendChild(entity);
        }
        testEntityAdded = true;
    });
};
    </script>
  </head>
  <body>
    <a-scene debug vr-mode-ui='enabled: false' arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false' renderer='antialias: true; alpha: true'>
      <a-camera gps-new-camera='gpsMinDistance: 5'></a-camera>
      <a-entity id="basebox" material="color: red" geometry="primitive: box" gps-new-entity-place="" scale="20 20 20">
        <a-sphere id="sun" color="yellow" opacity="1" radius="1" sun-position="" position="-137.45814848655226 39.505329325783975 139.80195409761015" scale="20 20 20"></a-sphere>
      </a-entity>
    </a-scene>
  </body>
</html>

