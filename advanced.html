<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/three.js/build/ar-threex-location-only.js'></script>
    <script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/suncalc/1.8.0/suncalc.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>    
    <script>
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          
          // Get the current date/time and GPS coordinates
          var date = new Date();
          var latitude = position.coords.latitude;
          var longitude = position.coords.longitude;

          // Calculate the position of the sun using SunCalc.js
          var sunPosition = SunCalc.getPosition(date, latitude, longitude);
              // Logging
              console.log("Azimuth: " + sunPosition.azimuth);
              console.log("Altitude: " + sunPosition.altitude);

          // Convert the azimuth and altitude to X, Y, and Z coordinates
          var radius = 10; // example radius of the sun object
          var x = radius * Math.cos(sunPosition.azimuth) * Math.sin(sunPosition.altitude);
          var y = radius * Math.cos(sunPosition.altitude);
          var z = -radius * Math.sin(sunPosition.azimuth) * Math.sin(sunPosition.altitude);

          // Create the "anchor" object and position it at the GPS coordinates
          var anchor = document.createElement('a-entity');
          anchor.setAttribute('gps-new-entity-place', `latitude: ${latitude}; longitude: ${longitude};`);
          document.querySelector('a-scene').appendChild(anchor);

          // Create the sun object and position it relative to the "anchor" object
          var sun = document.createElement('a-sphere');
          sun.setAttribute('radius', radius);
          sun.setAttribute('color', 'yellow');
          sun.setAttribute('position', `${x} ${y} ${z}`);
              // Logging
              console.log("x: " + x + " y: " + y +" z: " + z);
          anchor.appendChild(sun);
          
      }, function(error) {
        console.error(error);
      });
      } else {
        console.error('Geolocation is not supported by this browser.');
      }
    </script>
  </head>
  <body style="margin: 0;">
    <a-scene debug vr-mode-ui="enabled: false" arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false">
      <a-camera gps-new-camera="gpsMinDistance: 15"></a-camera>
    </a-scene>
  </body>
</html>
